[webserver]
115.146.86.130


[dbserver]
115.146.85.220
115.146.85.235
115.146.84.231    ////master

[install]
sudo su
apt-get update
apt-get -y install vim
apt-get -y install docker.io

[mount volume]
sudo su
mkfs.ext4 /dev/vdc
mkdir /mnt/database
touch /mnt/database/couchdb
mount /dev/vdc /mnt/database

[couchdb establishment]
sudo su
docker pull couchdb:2.1.1

docker create -v /mnt/database:/opt/couchdb/data -p 5984:5984 -p 4369:4369 -p 5986:5986 -p 9100-9200:9100-9200 --net=host couchdb:2.1.1

docker exec CONTAINER_ID bash -c "echo \"-setcookie couchdb_cluster\" >> /opt/couchdb/etc/vm.args"

docker exec CONTAINER_ID bash -c "echo \"-name couchdb@<local_ip>\" >> /opt/couchdb/etc/vm.args"

docker restart CONTAINER_ID 
sleep 1

curl -X PUT "http://<local_ip>:5984/_node/_local/_config/admins/<uname>" --data "\"<passward>\""

curl -X PUT "http://admin:admin@<local_ip>:5984/_node/couchdb@<local_ip>/_config/chttpd/bind_address" --data '"0.0.0.0"'


	[master]
	curl -X POST -H 'Content-Type: application/json' http://admin:admin@127.0.0.1:5984/_cluster_setup -d "{\"action\": \"enable_cluster\", \"bind_address\":\"0.0.0.0\", \"username\": \"admin\", \"password\":\"admin\", \"port\": 5984, \"node_count\": \"3\", \"remote_node\": \"<remote_ip>\", \"remote_current_user\": \"admin\", \"remote_current_password\": \"admin\"}"

	curl -X POST -H 'Content-Type: application/json' http://admin:admin@127.0.0.1:5984/_cluster_setup -d "{\"action\": \"add_node\", \"host\":\"<remote_ip>\", \"port\": 5984, \"username\": \"admin\", \"password\":\"admin\"}"

	[slave]



